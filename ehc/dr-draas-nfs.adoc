---
sidebar: sidebar 
permalink: ehc/dr-draas-nfs.html 
keywords: dr, draas, bluexp, disaster recovery, nfs datastore 
summary: 이 섹션에서는 다른 지정된 사이트에 대한 온프레미스 VMware VM의 재해 복구를 설정하기 위한 BlueXP  DRaaS 구성에 대해 설명합니다. 
---
= NFS 데이터 저장소용 BlueXP  DRaaS를 사용하는 DR
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


[role="lead"]
운영 사이트에서 재해 복구 사이트로의 블록 레벨 복제를 통해 재해 복구를 구현하면 랜섬웨어 공격과 같은 사이트 중단 및 데이터 손상 이벤트로부터 워크로드를 보호할 수 있는 복원력과 비용 효율적인 방법입니다. NetApp SnapMirror 복제를 사용하면 NFS 데이터 저장소가 있는 온프레미스 ONTAP 시스템에서 실행 중인 VMware 워크로드를 VMware가 구축된 지정된 복구 데이터 센터에 있는 다른 ONTAP 스토리지 시스템에 복제할 수 있습니다.

이 섹션에서는 다른 지정된 사이트에 대한 온프레미스 VMware VM의 재해 복구를 설정하기 위한 BlueXP  DRaaS 구성에 대해 설명합니다. 이 설정의 일부로 BlueXP  계정, BlueXP  커넥터, BlueXP  작업 공간 내에 추가된 ONTAP 어레이는 VMware vCenter에서 ONTAP 스토리지로의 통신을 지원하는 데 필요합니다. 또한 사이트 간 복제를 구성하는 방법과 복구 계획을 설정 및 테스트하는 방법에 대해 자세히 설명합니다. 마지막 섹션에는 전체 사이트 장애 조치를 수행하는 방법과 운영 사이트를 복구하여 온라인으로 구입할 때 장애 복구를 수행하는 방법이 나와 있습니다.

기업은 NetApp BlueXP  콘솔에 통합된 BlueXP  재해 복구 서비스를 사용하여 사내 VMware vCenter 및 ONTAP 스토리지를 쉽게 검색할 수 있습니다. 그런 다음 리소스 그룹을 만들고, 재해 복구 계획을 만들고, 리소스 그룹에 연결하고, 페일오버 및 페일백을 테스트하거나 실행할 수 있습니다. SnapMirror는 증분 변경 사항으로 두 사이트를 최신 상태로 유지할 수 있도록 스토리지 레벨 블록 복제를 제공하여 최대 5분의 RPO(복구 시점 목표)를 실현합니다. 또한 운영에 영향을 주거나 추가 스토리지 비용을 유발하지 않고 재해 복구 절차를 시뮬레이션할 수 있습니다.

BlueXP  재해 복구는 ONTAP의 FlexClone 기술을 활용하여 재해 복구 사이트의 마지막 복제 스냅샷에서 NFS 데이터 저장소의 공간 효율적인 복사본을 생성합니다. 재해 복구 테스트를 완료한 후 고객은 실제 복제된 프로덕션 리소스에 영향을 주지 않고 테스트 환경을 쉽게 삭제할 수 있습니다. 실제 페일오버 시 BlueXP  재해 복구 서비스는 단 몇 번의 클릭으로 지정된 재해 복구 사이트에서 보호된 가상 머신을 자동으로 실행하는 데 필요한 모든 단계를 조정합니다. 또한 이 서비스는 SnapMirror 관계를 운영 사이트로 되돌리고 필요한 경우 장애 복구 작업을 위해 2차 사이트에서 운영 사이트로 모든 변경 사항을 복제합니다. 이러한 모든 기능은 잘 알려진 다른 대안보다 훨씬 저렴한 비용으로 제공됩니다.

image::dr-draas-nfs-image1.png[DR DRaaS NFS 이미지1]



== 시작하기

BlueXP  재해 복구를 시작하려면 BlueXP  콘솔을 사용하여 서비스에 액세스합니다.

. BlueXP에 로그인합니다.
. BlueXP 의 왼쪽 탐색 모음에서 보호 > 재해 복구 를 선택합니다.
. BlueXP  재해 복구 대시보드가 나타납니다.
+
image::dr-draas-nfs-image2.png[DR DRaaS NFS 이미지2]



재해 복구 계획을 구성하기 전에 다음과 같은 사전 요구 사항이 충족되는지 확인하십시오.

* BlueXP  커넥터는 NetApp BlueXP 에 설정되어 있습니다.
* BlueXP  Connector 인스턴스는 소스 및 대상 vCenter 및 스토리지 시스템에 접속되어 있습니다.
* 스토리지 NFS 데이터 저장소를 제공하는 NetApp Data ONTAP 클러스터입니다.
* VMware용 NFS 데이터 저장소를 호스팅하는 온프레미스 NetApp 스토리지 시스템이 BlueXP 에 추가되었습니다.
* DNS 이름을 사용할 때 DNS 확인이 이루어져야 합니다. 그렇지 않은 경우 vCenter의 IP 주소를 사용하십시오.
* SnapMirror 복제는 지정된 NFS 기반 데이터 저장소 볼륨에 대해 구성됩니다.
* 해당 환경에서 지원되는 버전의 vCenter Server 및 ESXi Server가 있는지 확인합니다.


소스 사이트와 대상 사이트 간에 연결이 설정되면 몇 번의 클릭으로 약 3-5분 정도 걸리는 구성 단계를 진행합니다.


NOTE: BlueXP  커넥터가 네트워크를 통해 소스 및 대상 리소스와 통신할 수 있도록 대상 사이트 또는 타사 사이트에 BlueXP  커넥터를 배포하는 것이 좋습니다 NetApp.

image::dr-draas-nfs-image3.png[DR DRaaS NFS 이미지 3]



== BlueXP  재해 복구 구성

재해 복구를 준비하는 첫 번째 단계는 사내 vCenter 및 스토리지 리소스를 검색하여 BlueXP  재해 복구에 추가하는 것입니다.

BlueXP  콘솔을 열고 왼쪽 탐색 메뉴에서 * 보호 > 재해 복구 * 를 선택합니다. Discover vCenter servers * 를 선택하거나 상단 메뉴에서 * Sites > Add > Add vCenter * 를 선택합니다.

image::dr-draas-nfs-image4.png[DR DRaaS NFS 이미지 4]

다음 플랫폼을 추가합니다.

* * 소스 *. 온프레미스 vCenter.
+
image::dr-draas-nfs-image5.png[DR DRaaS NFS 이미지5]

* * 목적지 *. VMC SDDC vCenter 를 참조하십시오.
+
image::dr-draas-nfs-image6.png[DR DRaaS NFS 이미지6]



vCenter가 추가되면 자동화된 검색이 트리거됩니다.



== 소스 사이트 배열과 대상 사이트 배열 간의 스토리지 복제 구성

SnapMirror는 NetApp 환경에서 데이터 복제를 제공합니다. NetApp Snapshot ® 기술을 기반으로 하는 SnapMirror 복제는 이전 업데이트 이후에 변경되거나 추가된 블록만 복제하므로 매우 효율적입니다. SnapMirror는 NetApp OnCommand ® System Manager 또는 ONTAP CLI를 사용하여 쉽게 구성할 수 있습니다. 또한 BlueXP  DRaaS는 클러스터 및 SVM 피어링이 사전에 구성된 경우 SnapMirror 관계를 생성합니다.

운영 스토리지가 완전히 손실되지 않는 경우 SnapMirror를 사용하면 운영 사이트와 DR 사이트를 효율적으로 재동기화할 수 있습니다. SnapMirror는 두 사이트를 다시 동기화하고, SnapMirror 관계를 되돌리기만 하면 변경된 데이터나 새 데이터만 DR 사이트에서 운영 사이트로 다시 전송할 수 있습니다. 즉, 전체 볼륨을 재복사하지 않고 페일오버 후 어느 방향으로든 BlueXP  DRaaS의 복제 계획을 재동기화할 수 있습니다. 관계가 반대 방향으로 다시 동기화되면 마지막으로 성공한 스냅샷 복제본 동기화 이후에 기록된 새 데이터만 타겟으로 다시 전송됩니다.


NOTE: SnapMirror 관계가 CLI 또는 System Manager를 통해 볼륨에 대해 이미 구성된 경우 BlueXP  DRaaS가 관계를 선택하고 나머지 워크플로 작업을 계속합니다.



== VMware 재해 복구를 위한 설정 방법

SnapMirror 복제를 생성하는 프로세스는 특정 애플리케이션에 대해 동일하게 유지됩니다. 이 프로세스는 수동 또는 자동화될 수 있습니다. 가장 쉬운 방법은 BlueXP 를 활용하여 운영 환경에서 소스 ONTAP 시스템을 대상으로 간단하게 끌어서 놓아 SnapMirror 복제를 구성하는 것입니다. 이렇게 하면 나머지 프로세스의 안내를 해 주는 마법사를 시작할 수 있습니다.

image::dr-draas-nfs-image7.png[DR DRaaS NFS 이미지7]

BlueXP  DRaaS는 다음 두 가지 기준을 충족하면 동일한 기능을 자동화할 수 있습니다.

* 소스 및 대상 클러스터는 피어 관계를 갖습니다.
* 소스 SVM 및 타겟 SVM은 피어 관계를 갖습니다.
+
image::dr-draas-nfs-image8.png[DR DRaaS NFS 이미지8]




NOTE: SnapMirror 관계가 CLI를 통해 볼륨에 대해 이미 구성된 경우 BlueXP  DRaaS가 관계를 선택하고 나머지 워크플로 작업을 계속합니다.



== BlueXP  재해 복구를 통해 얻을 수 있는 이점은 무엇입니까?

소스 및 대상 사이트가 추가되면 BlueXP  재해 복구는 자동 세부 검색을 수행하고 VM을 관련 메타데이터와 함께 표시합니다. 또한 BlueXP  재해 복구에서는 VM에서 사용하는 네트워크 및 포트 그룹을 자동으로 감지하여 채웁니다.

image::dr-draas-nfs-image9.png[DR DRaaS NFS 이미지9]

사이트를 추가한 후 VM을 리소스 그룹으로 그룹화할 수 있습니다. BlueXP  재해 복구 리소스 그룹을 사용하면 복구 시 실행할 수 있는 부트 순서 및 부트 지연이 포함된 논리적 그룹으로 종속 VM 집합을 그룹화할 수 있습니다. 리소스 그룹 만들기를 시작하려면 * 리소스 그룹 * 으로 이동하고 * 새 리소스 그룹 생성 * 을 클릭합니다.

image::dr-draas-nfs-image10.png[DR DRaaS NFS 이미지 10]

image::dr-draas-nfs-image11.png[DR DRaaS NFS 이미지11]


NOTE: 복제 계획을 생성하는 동안 리소스 그룹을 생성할 수도 있습니다.

VM의 부팅 순서는 간단한 끌어서 놓기 메커니즘을 사용하여 리소스 그룹을 생성하는 동안 정의하거나 수정할 수 있습니다.

image::dr-draas-nfs-image12.png[DR DRaaS NFS 이미지12]

리소스 그룹이 생성되면 다음 단계는 실행 청사진 또는 재해 발생 시 가상 머신 및 애플리케이션을 복구하는 계획을 만드는 것입니다. 사전 요구 사항에 설명된 대로 SnapMirror 복제를 미리 구성하거나 DRaaS에서 복제 계획 생성 시 지정된 RPO 및 보존 수를 사용하여 구성할 수 있습니다.

image::dr-draas-nfs-image13.png[DR DRaaS NFS 이미지13]

image::dr-draas-nfs-image14.png[DR DRaaS NFS 이미지14]

드롭다운에서 소스 및 대상 vCenter 플랫폼을 선택하고 계획에 포함할 리소스 그룹을 선택하고 애플리케이션을 복구하고 전원을 켜는 방법 및 클러스터와 네트워크의 매핑 방법을 그룹화하여 복제 계획을 구성합니다. 복구 계획을 정의하려면 * Replication Plan * 탭으로 이동하고 * Add Plan * 을 클릭합니다.

먼저 소스 vCenter를 선택한 다음 대상 vCenter를 선택합니다.

image::dr-draas-nfs-image15.png[DR DRaaS NFS 이미지15]

다음 단계는 기존 리소스 그룹을 선택하는 것입니다. 생성된 리소스 그룹이 없는 경우 마법사는 복구 목표에 따라 필요한 가상 머신을 그룹화합니다(기본적으로 기능적 리소스 그룹을 생성). 또한 응용 프로그램 가상 컴퓨터를 복원하는 방법에 대한 작업 순서를 정의하는 데 도움이 됩니다.

image::dr-draas-nfs-image16.png[DR DRaaS NFS 이미지16]


NOTE: 리소스 그룹을 사용하면 끌어서 놓기 기능을 사용하여 부팅 순서를 설정할 수 있습니다. 복구 프로세스 중에 VM의 전원이 켜지는 순서를 쉽게 수정하는 데 사용할 수 있습니다.


NOTE: 리소스 그룹 내의 각 가상 머신은 순서에 따라 순서대로 시작됩니다. 두 리소스 그룹이 동시에 시작됩니다.

아래 스크린샷은 리소스 그룹을 미리 생성하지 않은 경우 조직 요구 사항에 따라 가상 머신 또는 특정 데이터 저장소를 필터링하는 옵션을 보여 줍니다.

image::dr-draas-nfs-image17.png[DR DRaaS NFS 이미지17]

리소스 그룹이 선택되면 페일오버 매핑을 생성합니다. 이 단계에서는 소스 환경의 리소스가 대상에 매핑되는 방법을 지정합니다. 여기에는 컴퓨팅 리소스, 가상 네트워크가 포함됩니다. IP 사용자 정의, 사전/사후 스크립트, 부팅 지연, 애플리케이션 정합성 등 자세한 내용은 을 link:https://docs.netapp.com/us-en/bluexp-disaster-recovery/use/drplan-create.html#select-applications-to-replicate-and-assign-resource-groups["복제 계획을 생성합니다"]참조하십시오.

image::dr-draas-nfs-image18.png[DR DRaaS NFS 이미지18]


NOTE: 기본적으로 테스트 및 페일오버 작업 모두에 동일한 매핑 매개 변수가 사용됩니다. 테스트 환경에 대해 서로 다른 매핑을 설정하려면 아래와 같이 확인란을 선택 해제한 후 테스트 매핑 옵션을 선택합니다.

image::dr-draas-nfs-image19.png[DR DRaaS NFS 이미지 19]

리소스 매핑이 완료되면 Next를 클릭합니다.

image::dr-draas-nfs-image20.png[DR DRaaS NFS 이미지20]

되풀이 유형을 선택합니다. 간단히 말해 마이그레이션(페일오버를 사용하여 한 번 마이그레이션) 또는 반복 연속 복제 옵션을 선택합니다. 이 연습에서는 복제 옵션이 선택되어 있습니다.

image::dr-draas-nfs-image21.png[DR DRaaS NFS 이미지21]

완료되면 생성된 매핑을 검토한 후 * 계획 추가 * 를 클릭합니다.


NOTE: 서로 다른 볼륨 및 SVM의 VM을 복제 계획에 포함할 수 있습니다. VM 배치(동일한 SVM 내의 동일한 볼륨 또는 별도의 볼륨, 서로 다른 SVM에 있는 별도의 볼륨)에 따라 BlueXP  재해 복구에서 일관성 그룹 스냅샷이 생성됩니다.

image::dr-draas-nfs-image22.png[DR DRaaS NFS 이미지22]

image::dr-draas-nfs-image23.png[DR DRaaS NFS 이미지23]

BlueXP  DRaaS는 다음과 같은 워크플로로 구성됩니다.

* 테스트 장애 조치(주기적인 자동 시뮬레이션 포함)
* 장애 조치 테스트를 정리합니다
* 페일오버
* 장애 복구




== 테스트 대체 작동

BlueXP  DRaaS의 테스트 페일오버는 VMware 관리자가 운영 환경을 중단하지 않고 복구 계획을 완벽하게 검증할 수 있는 운영 절차입니다.

image::dr-draas-nfs-image24.png[DR DRaaS NFS 이미지24]

BlueXP  DRaaS는 테스트 페일오버 작업에서 스냅샷을 선택적 기능으로 선택할 수 있는 기능을 포함하고 있습니다. 이 기능을 통해 VMware 관리자는 환경에서 최근에 변경한 내용이 대상 사이트에 복제되어 테스트 중에 존재하는지 확인할 수 있습니다. 이러한 변경에는 VM 게스트 운영 체제에 대한 패치가 포함됩니다

image::dr-draas-nfs-image25.png[DR DRaaS NFS 이미지25]

VMware 관리자가 테스트 페일오버 작업을 실행할 때 BlueXP  DRaaS는 다음과 같은 작업을 자동화합니다.

* SnapMirror 관계를 트리거하여 프로덕션 사이트에서 최근에 변경한 내용으로 대상 사이트의 스토리지를 업데이트합니다.
* DR 스토리지 어레이에서 FlexVol 볼륨의 NetApp FlexClone 볼륨을 생성합니다.
* FlexClone 볼륨의 NFS 데이터 저장소를 DR 사이트의 ESXi 호스트에 연결합니다.
* 매핑 중에 지정된 테스트 네트워크에 VM 네트워크 어댑터를 연결합니다.
* DR 사이트의 네트워크에 대해 정의된 대로 VM 게스트 운영 체제 네트워크 설정을 재구성합니다.
* 복제 계획에 저장된 사용자 지정 명령을 실행합니다.
* 복제 계획에 정의된 순서대로 VM의 전원을 켭니다.
+
image::dr-draas-nfs-image26.png[DR DRaaS NFS 이미지 26]





== 페일오버 테스트 작업을 정리합니다

정리 페일오버 테스트 작업은 복제 계획 테스트가 완료된 후 수행되며 VMware 관리자가 정리 프롬프트에 응답합니다.

image::dr-draas-nfs-image27.png[DR DRaaS NFS 이미지 27]

이 작업은 가상 머신(VM)과 복제 계획의 상태를 준비 상태로 재설정합니다.

VMware 관리자가 복구 작업을 수행하면 BlueXP  DRaaS가 다음 프로세스를 완료합니다.

. 테스트에 사용된 FlexClone 복사본에서 복구된 각 VM의 전원을 끕니다.
. 테스트 중에 복구된 VM을 제공하는 데 사용된 FlexClone 볼륨이 삭제됩니다.




== 계획된 마이그레이션 및 페일오버

BlueXP  DRaaS는 계획된 마이그레이션과 장애 조치라는 두 가지 방법으로 실제 페일오버를 수행합니다. 첫 번째 방법인 계획된 마이그레이션은 VM 종료 및 스토리지 복제 동기화를 프로세스에 통합하여 VM을 복구하거나 대상 사이트로 효과적으로 이동합니다. 계획된 마이그레이션을 수행하려면 소스 사이트에 액세스해야 합니다. 두 번째 방법인 페일오버는 마지막 스토리지 복제 간격부터 대상 사이트에서 VM이 복구되는 계획된/계획되지 않은 페일오버입니다. 솔루션에 설계된 RPO에 따라 DR 시나리오에서 어느 정도의 데이터 손실을 예상할 수 있습니다.

image::dr-draas-nfs-image28.png[DR DRaaS NFS 이미지 28]

VMware 관리자가 페일오버 작업을 수행할 때 BlueXP  DRaaS는 다음과 같은 작업을 자동화합니다.

* NetApp SnapMirror 관계의 중단 및 페일오버
* 복제된 NFS 데이터 저장소를 DR 사이트의 ESXi 호스트에 연결합니다.
* VM 네트워크 어댑터를 적절한 대상 사이트 네트워크에 연결합니다.
* 대상 사이트의 네트워크에 대해 정의된 대로 VM 게스트 운영 체제 네트워크 설정을 재구성합니다.
* 복제 계획에 저장된 모든 사용자 지정 명령(있는 경우)을 실행합니다.
* 복제 계획에 정의된 순서대로 VM의 전원을 켭니다.


image::dr-draas-nfs-image29.png[DR DRaaS NFS 이미지 29]



== 장애 복구

페일백은 복구 후 소스 및 대상 사이트의 원래 구성을 복원하는 선택적 절차입니다.

image::dr-draas-nfs-image30.png[DR DRaaS NFS 이미지30]

VMware 관리자는 원래 소스 사이트에 서비스를 복구할 준비가 되면 페일백 절차를 구성하고 실행할 수 있습니다.

* 참고: * BlueXP  DRaaS는 복제 방향을 바꾸기 전에 모든 변경 사항을 원래 소스 가상 머신으로 다시 복제합니다. 이 프로세스는 대상에 대한 장애 조치를 완료한 관계에서 시작하며 다음 단계를 포함합니다.

* 가상 머신의 전원을 끄고 등록을 취소합니다. 대상 사이트의 볼륨이 마운트 해제됩니다.
* Break 원본 소스의 SnapMirror 관계가 깨져 읽기/쓰기가 됩니다.
* SnapMirror 관계를 다시 동기화하여 복제를 반대로 수행합니다.
* 소스에 볼륨을 마운트하고 전원을 켜고 소스 가상 머신을 등록합니다.


BlueXP  DRaaS 액세스 및 구성에 대한 자세한 내용은 을 link:https://docs.netapp.com/us-en/bluexp-disaster-recovery/get-started/dr-intro.html["VMware를 위한 BlueXP  재해 복구 에 대해 알아보십시오"]참조하십시오.



== 모니터링 및 대시보드

BlueXP  또는 ONTAP CLI에서 적절한 데이터 저장소 볼륨의 복제 상태를 모니터링할 수 있으며 작업 모니터링을 통해 페일오버 또는 테스트 페일오버 상태를 추적할 수 있습니다.

image::dr-draas-nfs-image31.png[DR DRaaS NFS 이미지 31]


NOTE: 작업이 현재 진행 중이거나 대기열에 있으며 중지하려는 경우 취소할 수 있는 옵션이 있습니다.

BlueXP  재해 복구 대시보드를 사용하여 재해 복구 사이트 및 복제 계획의 상태를 확실하게 평가할 수 있습니다. 이를 통해 관리자는 정상 사이트, 연결 끊김 또는 성능 저하 사이트 및 계획을 신속하게 식별할 수 있습니다.

image::dr-draas-nfs-image32.png[DR DRaaS NFS 이미지32를 참조하십시오]

사용자 지정된 맞춤형 재해 복구 계획을 처리할 수 있는 강력한 솔루션을 제공합니다. 재해가 발생하고 DR 사이트를 활성화하기로 결정한 경우 버튼 클릭 한 번으로 계획된 페일오버 또는 페일오버로 페일오버를 수행할 수 있습니다.

이 프로세스에 대해 자세히 알아보려면 자세한 안내 비디오를 보거나 를 link:https://netapp.github.io/bluexp-draas-simulator/?frame-1["솔루션 시뮬레이터"]사용하십시오.
