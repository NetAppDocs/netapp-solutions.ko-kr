---
sidebar: sidebar 
permalink: ehc/gcp/gcp-app-dr-sc-cvs-veeam.html 
keywords: gcp, gcve, snapcenter, cvo, cvs, iscsi, guest connect, dr, disaster recovery 
summary: 클라우드로 재해 복구는 랜섬웨어 등 사이트 운영 중단 및 데이터 손상 이벤트로부터 워크로드를 보호하는 복원력이 있는 비용 효율적인 방법입니다. NetApp SnapMirror를 사용하면 게스트 연결 스토리지를 사용하는 사내 VMware 워크로드를 Google Cloud에서 실행 중인 NetApp Cloud Volumes ONTAP로 복제할 수 있습니다. 
---
= NetApp SnapCenter 및 Veeam 복제를 통해 애플리케이션 정합성이 보장되는 재해 복구
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../../media/




== 개요

저자: NetApp Suesh Thoppay

많은 고객이 VMware vSphere에서 호스팅되는 애플리케이션 VM을 위한 효율적인 재해 복구 솔루션을 찾고 있습니다. 이 중 다수는 기존 백업 솔루션을 사용하여 DIaster를 실행하는 동안 복구를 수행합니다.
이러한 솔루션은 RTO를 높여주고 기대에 미치지 못합니다. RPO 및 RTO를 줄이기 위해 적절한 권한이 있는 네트워크 연결 및 환경을 사용할 수 있는 한 Veeam VM 복제를 사내에서 GCVE로 활용할 수 있습니다.


NOTE: Veeam VM 복제는 iSCSI 또는 NFS 마운트 같은 VM 게스트 연결 스토리지 디바이스를 게스트 VM 내에 보호하지 않습니다. 별도로 보호해야 합니다.

SQL VM의 애플리케이션 정합성이 보장되는 복제 및 RTO를 줄이기 위해 SnapCenter을 사용하여 SQL 데이터베이스 및 로그 볼륨의 SnapMirror 작업을 오케스트레이션했습니다.

이 문서에서는 NetApp SnapMirror, Veeam 및 Google Cloud VMware Engine(GCVE)을 사용하는 재해 복구를 설정하고 수행하기 위한 단계별 접근 방식을 제공합니다.

image:dr-cvs-gcve-veeam-image1.png["애플리케이션 VM 복제 아키텍처"]



== 가정

이 문서에서는 애플리케이션 데이터(게스트 연결)를 위한 게스트 내 스토리지에 초점을 두고 사내 환경에서 애플리케이션 정합성 보장 백업을 위해 SnapCenter를 사용하고 있다고 가정합니다.


NOTE: 이 문서는 타사 백업 또는 복구 솔루션에 적용됩니다. 환경에 사용된 솔루션에 따라 Best Practice를 따라 조직 SLA를 충족하는 백업 정책을 생성합니다.

온프레미스 환경과 Google Cloud 네트워크 간의 연결을 위해 전용 상호 연결 또는 Cloud VPN과 같은 연결 옵션을 사용합니다. 세그먼트는 사내 VLAN 설계를 기반으로 생성해야 합니다.


NOTE: 온프레미스 데이터 센터를 Google Cloud에 연결하는 옵션에는 여러 가지가 있으며, 이로 인해 NetApp에서 이 문서의 특정 워크플로우를 개괄적으로 설명하지 못하게 됩니다. 적절한 온프레미스-Google 연결 방법은 Google Cloud 설명서를 참조하십시오.



== DR 솔루션 구축



=== 솔루션 구축 개요

. 필요한 RPO 요구 사항에 따라 SnapCenter를 사용하여 애플리케이션 데이터를 백업했는지 확인합니다.
. 적절한 가입 및 가상 네트워크 내에서 BlueXP를 사용하여 Cloud Volumes ONTAP의 인스턴스 크기를 올바르게 프로비저닝합니다.
+
.. 관련 애플리케이션 볼륨에 대해 SnapMirror를 구성합니다.
.. 예약된 작업 후 SnapMirror 업데이트를 트리거하도록 SnapCenter의 백업 정책을 업데이트합니다.


. Veeam 소프트웨어를 설치하고 Google Cloud VMware Engine 인스턴스에 가상 머신 복제를 시작합니다.
. 재해 발생 시 BlueXP를 사용하여 SnapMirror 관계를 중단시키고 Veeam으로 가상 시스템의 페일오버를 트리거하십시오.
+
.. 애플리케이션 VM에 대한 iSCSI LUN 및 NFS 마운트를 다시 연결합니다.
.. 애플리케이션을 온라인으로 전환합니다.


. 운영 사이트가 복구된 후 SnapMirror를 다시 동기화하여 보호 사이트에 대한 페일백을 호출합니다.




=== 배포 세부 정보

.Google Cloud에서 CVO를 구성하고 볼륨을 CVO로 복제합니다
[%collapsible]
====
첫 번째 단계는 Google Cloud에서 Cloud Volumes ONTAP를 구성하는 것입니다 (https://docs.netapp.com/us-en/netapp-solutions/ehc/gcp/gcp-guest.html["CVO"^])를 사용하여 원하는 볼륨을 Cloud Volumes ONTAP에 복제하고 원하는 빈도와 스냅샷 보존 기능을 사용할 수 있습니다.

image:dr-cvo-gcve-image2.png["오류: 그래픽 이미지가 없습니다"]

SnapCenter 설정 및 데이터 복제에 대한 단계별 지침은 을 참조하십시오 https://docs.netapp.com/us-en/netapp-solutions/ehc/aws/aws-guest-dr-config-snapmirror.html["SnapCenter를 사용하여 복제를 설정합니다"]

video::dr-cvo-gcve-video2.mp4[Review of SQL VM protection with SnapCenter]
====
.GCVE 호스트 및 CVO 데이터 액세스를 구성합니다
[%collapsible]
====
SDDC를 배포할 때 고려해야 할 두 가지 중요한 요소는 GCVE 솔루션의 SDDC 클러스터의 크기와 SDDC를 사용할 수 있는 기간 입니다. 재해 복구 솔루션의 두 가지 주요 고려 사항은 전체 운영 비용을 절감하는 데 도움이 됩니다. SDDC는 최대 3개의 호스트까지 구성할 수 있으며, 전체 구축 환경에서 다중 호스트 클러스터까지 가능합니다.

NFS 데이터 저장소용 NetApp Cloud Volume Service와 SQL 데이터베이스 및 로그용 Cloud Volumes ONTAP를 모든 VPC 및 GCVE에 구축할 수 있습니다. NFS 데이터 저장소를 마운트하고 VM을 iSCSI LUN에 연결하려면 해당 VPC에 대한 전용 연결이 있어야 합니다.

GCVE SDDC를 구성하려면 를 참조하십시오 https://docs.netapp.com/us-en/netapp-solutions/ehc/gcp/gcp-setup.html["Google Cloud Platform(GCP)에서 가상화 환경 구축 및 구성"^]. 사전 요구 사항으로, 연결이 설정된 후 GCVE 호스트에 상주하는 게스트 VM이 Cloud Volumes ONTAP의 데이터를 사용할 수 있는지 확인합니다.

Cloud Volumes ONTAP 및 GCVE가 올바르게 구성된 후에는 Veeam 복제 기능을 사용하고 Cloud Volumes ONTAP에 애플리케이션 볼륨 복사본에 SnapMirror를 활용하여 사내 워크로드(게스트 내 스토리지가 있는 애플리케이션 VMDK 및 VM이 있는 VM)를 GCVE로 자동 복구하도록 Veeam 구성을 시작하십시오.

====
.Veeam 구성 요소를 설치합니다
[%collapsible]
====
Veeam 백업 서버, 백업 저장소 및 구축해야 하는 백업 프록시가 구축 시나리오에 기반을 두고 있습니다. 이 경우 Veeam 및 스케일아웃 저장소에도 오브젝트 저장소를 구축할 필요가 없습니다.
https://helpcenter.veeam.com/docs/backup/vsphere/replication_components.html?ver=120["설치 절차는 Veeam 설명서를 참조하십시오"]
자세한 내용은 을 참조하십시오 link:gcp-migrate-veeam.html["Veeam 복제를 사용한 마이그레이션"]

====
.Veeam으로 VM 복제를 설정합니다
[%collapsible]
====
사내 vCenter와 GCVE vCenter를 모두 Veeam에 등록해야 합니다. https://helpcenter.veeam.com/docs/backup/vsphere/replica_job.html?ver=120["vSphere VM 복제 작업을 설정합니다"] 마법사의 게스트 처리 단계에서 애플리케이션 인식 백업 및 복구를 위해 SnapCenter를 활용할 예정이므로 애플리케이션 처리 비활성화 를 선택합니다.

video::dr-cvo-gcve-video1.mp4[Veeam Replication Job of SQL VM]
====
.Microsoft SQL Server VM의 페일오버
[%collapsible]
====
video::dr-cvo-gcve-video3.mp4[Failover of SQL VM]
====


== 이 솔루션의 이점

* SnapMirror의 효율적이고 복원력이 뛰어난 복제를 사용합니다.
* ONTAP 스냅샷 보존을 사용하여 사용 가능한 모든 시점 복구
* 스토리지, 컴퓨팅, 네트워크 및 애플리케이션 검증 단계에서 수백 또는 수천 개의 VM을 복구하는 데 필요한 모든 단계에서 완전한 자동화가 가능합니다.
* SnapCenter는 복제된 볼륨을 변경하지 않는 클론 생성 메커니즘을 사용합니다.
+
** 이렇게 하면 볼륨 및 스냅숏에 대한 데이터 손상 위험이 방지됩니다.
** DR 테스트 워크플로우 중에 복제 중단 방지
** 개발/테스트, 보안 테스트, 패치 및 업그레이드 테스트, 수정 테스트 등 DR 이외의 워크플로우에 DR 데이터를 활용합니다.


* Veeam Replication을 사용하면 DR 사이트에서 VM IP 주소를 변경할 수 있습니다.

